<form [formGroup]="createApartmentForm" (ngSubmit)="onSubmit()" *ngIf="!isLoading && !unexpectedError">
    <div class="d-flex justify-content-between">
        <h3 *ngIf="isEdit" style="color:white; margin-left:5px">Update apartment</h3>
        <h3 *ngIf="!isEdit" style="color:white; margin-left:5px">New apartment</h3>
    </div>
    <hr style="color:white; font-weight: 1000;">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="mb-3">
                <div class="input-group">
                    <span class="input-group-text"><i class="bi bi-5-square" style="font-size: 24px;"></i></span>
                    <input type="text" class="form-control" formControlName="number" placeholder="Number" [class.is-invalid]="createApartmentForm.controls['number'].dirty && createApartmentForm.hasError('required','number')">
                </div>
                <span *ngIf="createApartmentForm.controls['number'].dirty && createApartmentForm.hasError('required','number')" class="text-danger bold">Field is required</span>
            </div>
            <div class="mb-3">
                <div class="input-group">
                    <span class="input-group-text"><i class="bi bi-cash-stack" style="font-size: 24px;"></i></span>
                    <input type="text" class="form-control" formControlName="price" placeholder="Price" [class.is-invalid]="createApartmentForm.controls['price'].dirty && createApartmentForm.hasError('required','price')">
                </div>
                <span *ngIf="createApartmentForm.controls['price'].dirty && createApartmentForm.hasError('required','price')" class="text-danger bold">Field is required</span>
            </div>
            <div class="mb-3">
                <div class="input-group">
                    <span class="input-group-text"><i class="bi bi-house" style="font-size: 24px;"></i></span>
                    <input type="text" class="form-control" formControlName="rooms" placeholder="Room amount" [class.is-invalid]="createApartmentForm.controls['rooms'].dirty && createApartmentForm.hasError('required','rooms')">
                </div>
                <span *ngIf="createApartmentForm.controls['rooms'].dirty && createApartmentForm.hasError('required','rooms')" class="text-danger bold">Field is required</span>
            </div>
            <div class="mb-3">
                <div class="input-group">
                    <span class="input-group-text"><i class="bi bi-globe-americas" style="font-size: 24px;"></i></span>
                    <input type="text" class="form-control" formControlName="city" placeholder="City" [class.is-invalid]="createApartmentForm.controls['city'].dirty && createApartmentForm.hasError('required','city')">
                </div>
                <span *ngIf="createApartmentForm.controls['city'].dirty && createApartmentForm.hasError('required','city')" class="text-danger bold">Field is required</span>
            </div>
            <div class="mb-3">
                <div class="input-group">
                    <span class="input-group-text"><i class="bi bi-geo-alt" style="font-size: 24px;"></i></span>
                    <input type="text" class="form-control" formControlName="address" placeholder="Address" [class.is-invalid]="createApartmentForm.controls['address'].dirty && createApartmentForm.hasError('required','address')">
                </div>
                <span *ngIf="createApartmentForm.controls['address'].dirty && createApartmentForm.hasError('required','address')" class="text-danger bold">Field is required</span>
            </div>
            <div class="mb-3">
                <div class="input-group">
                    <span class="input-group-text"><i class="bi bi-person-fill" style="font-size: 24px;"></i></span>
                    <input type="text" class="form-control" formControlName="realtorName" placeholder="Realtor name" [class.is-invalid]="createApartmentForm.controls['realtorName'].dirty && createApartmentForm.hasError('required','realtorName')">
                </div>
                <span *ngIf="createApartmentForm.controls['realtorName'].dirty && createApartmentForm.hasError('required','realtorName')" class="text-danger bolder">Field is required</span>
            </div>
            <div class="mb-3">
                <div class="input-group">
                    <span class="input-group-text"><i class="bi bi-telephone-fill" style="font-size: 24px;"></i></span>
                    <input type="text" class="form-control" formControlName="realtorPhone" placeholder="Realtor phone" [class.is-invalid]="createApartmentForm.controls['realtorPhone'].dirty && createApartmentForm.hasError('required','realtorPhone')">
                </div>
                <span *ngIf="createApartmentForm.controls['realtorPhone'].dirty && createApartmentForm.hasError('required','realtorPhone')" class="text-danger bolder">Field is required</span>
            </div>
        </div>
    </div>
    <div *ngIf="isEdit">
        <h3 style="color:white; margin-left:5px; margin-top:25px">Apartment main photo</h3>
        <p style="color:white; margin-left:5px">Photo will be uploaded or deleted momentarily without clicking 'Update'</p>
        <hr style="color:white; font-weight: 1000;">
        <div class="row justify-content-center mt-1" *ngIf="isEdit">
            <div class="col-lg-4" *ngIf="apartment.imageUrl">
                <img class="create_apartment_form_photo main_photo" [src]="apiUrlImagesHttps + apartment.imageUrl">
                <div class="text-center mt-2">
                    <button type="button" class="btn btn-danger" (click)="deletePhoto()">Delete</button>
                </div>
            </div>
            <div class="col-lg-4" *ngIf="!apartment.imageUrl">
                <div class="create_apartment_form_photo_input">
                    <input type="file" (change)="onMainPhotoInputChange($event)">
                </div>
            </div>
        </div>
    </div>
    <div *ngIf="isEdit">
        <h3 style="color:white; margin-left:5px">Apartment photos</h3>
        <p style="color:white; margin-left:5px">Photo will be uploaded or deleted momentarily without clicking 'Update'</p>
        <hr style="color:white; font-weight: 1000;">
        <div class="row justify-content-center mt-1" *ngIf="isEdit">
            <div class="col-lg-4" *ngFor="let photo of apartment.photos">
                <img class="create_apartment_form_photo photo" [src]="apiUrlImagesHttps + photo.imageUrl">
                <div class="text-center my-2">
                    <button type="button" class="btn btn-danger" (click)="deletePhoto(photo.id)">Delete</button>
                </div>
            </div>
            <div class="col-lg-4">
                <div class="create_apartment_form_photo_input">
                    <input type="file" (change)="onPhotoInputChange($event)">
                </div>
            </div>
        </div>
    </div>
    <div class="text-center my-3">
        <button type="submit" class="custom-btn btn-confirm" *ngIf="!isEdit && createApartmentForm.valid"><i class="bi bi-upload"></i> Create</button>
        <button type="submit" class="custom-btn btn-update" *ngIf="isEdit && createApartmentForm.valid"><i class="bi bi-upload"></i> Update</button>
        <button type="button" class="custom-btn btn-delete" *ngIf="isEdit"><i class="bi bi-trash3"></i> Delete</button>
        <button type="button" class="custom-btn btn-cancel" [routerLink]="['/Apartments']"><i class="bi bi-x-square"></i> Cancel</button>
    </div>
</form>
<app-loading-state *ngIf="isLoading"></app-loading-state>
<app-error *ngIf="unexpectedError" [error]="unexpectedError"></app-error>
<app-error-modal *ngIf="errorModalContent" [content]="errorModalContent" (errorModalClosed)="closeErrorModal()"></app-error-modal>
